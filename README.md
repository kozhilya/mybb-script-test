# Шаблон скрипта для сервиса Forumd-Utils

## Минимальная структура скрипта
```
| dist
+-+
| | script.min.js
|
| package.json
```

`script.min.js` - минимизированный файл со скриптом, который будет включаться в основной файл.

`package.json` - 
```json
{
    "name": "script",
    "version": "0.0.1",
    "main": "dist/script.min.js",
    "description": "Скрипт",
    "author": "kozhilya"
}
```
Поле `name` является обязательным в файле `package.json`, однако не влияет на генерацию остальных
вещей.

## Как происходит обработка версии

Сервис импорта версии скрипта производит несколько действий и проверок, которые будут основаны 
на содержимом файла `package.json`.

### 1. Загрузка релизных версий
Сервис обрабатывает все релизные версии скрипта (блок _Releases_ справа на Github). 
Если будут найдены новые релизные версии, скрипт скачает архив, прикреплённый к версии (создаётся
автоматически), и извлекает из него файл `package.json`.

### 2. Проверка номера релиза 
В извлечённом файле `package.json` проверяется версия скрипта в поле `version`:
```js
{
    // ...
    "version": "0.1.0",
    // ...
}
```
Именно **эта версия** будет сохраняться в базе данных, а не версия, указанная в теге релиза!

Если несколько релизов указывают одну и ту же версию, более новый релиз будет пропущен. 

### 3. Загрузка файла скрипта
Сервис извлекает из архива файл скрипта, указанный в поле `main`:
```js
{
    // ...
    "main": "dist/mybb-script-test.min.js",
    // ...
}
```
Содержимое этого файла _без изменений_ будет использоваться сервисом при генерировании конечных
файлов, поэтому его содержимое желательно минимизировать.

### 4. Генераций баннера
Для каждой версии скрипта генерируется свой баннер по следующему шаблону:
```js
/**
 * ${description}, v.${version} (${date})
 * Автор: ${author}
 */
```
где `${description}`, `${version}` и `${author}` берутся из соответствующих полей `package.json`, 
а `${date}` - на основе даты создания релиза.